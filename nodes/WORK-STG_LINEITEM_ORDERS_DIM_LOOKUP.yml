steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-f672b22b-1747-4161-aeeb-ac787551c24e:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 6bb058f9-b734-4f89-9418-203f71f71fe0
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d7e4e531-c0b4-4ef3-8703-781533f8929e
                    stepCounter: 14bf6cba-1bbc-45e8-916e-3bde401e2c0a
                transform: ""
          - columnReference:
              columnCounter: 45432f89-465d-4373-b7e3-37d19cb25175
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 59819f18-db1e-4fb0-8924-a7ac1d2805d5
                    stepCounter: b0f685c5-2190-48d3-8e4a-31cf703035f1
                transform: ""
          - columnReference:
              columnCounter: 911fe56a-b755-4a15-8578-23e9d42182b6
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d6ed576b-5650-42c2-bc60-46dc2b52a85f
                    stepCounter: 34a53b67-f6d4-4857-9fbb-153b378f1382
                transform: ""
          - columnReference:
              columnCounter: 5f1cfa84-9e94-47d8-b9fe-223852e181d9
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8da0a84b-5a56-4376-8f28-4f4ca86d1640
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 6346b6f0-b191-4d08-816b-c36b23a6c3ae
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a211e5ef-bfc3-46c1-8b13-ce8e83c08845
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: d4560b45-6fbb-42cc-ba2d-c7a0c3fb27f6
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3472eb20-172d-4fa5-8087-12dfece5224f
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: e1680d20-5058-43d4-93c9-1707837ea861
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8832650c-8983-466b-9f57-74f34d5abf95
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: fcd183b9-b4f0-43ca-8135-9fefb68112a1
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: affd2290-9aad-4490-8927-4b856f987c5a
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 1a02e346-7fc3-4e38-9ed0-1dc894cca8b2
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ce8d6998-1af8-477c-a90f-4740b0b61985
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 72779013-b0fa-4674-9428-041f938fec8e
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 844426b9-ae8d-4473-bad6-d4e37fee511e
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 636aa8c2-8c94-40ff-a579-9215a9a0df4b
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 5e70d6dc-e6dc-49b9-931d-0c695bc8f075
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 1f539893-4c6e-4790-b2f4-3f5ec9846d04
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 00ec353d-5ba2-49ae-8a25-d1715d82cbdb
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 49c4b5ce-c563-4ec3-804b-d2db38088292
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1a37efd7-0b4a-4af2-9fdf-701fb9c9c27e
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: efa4c310-d5c0-4b18-ab87-468a1d800430
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: cbeb7a31-5d7e-406f-a249-da947d17bfd4
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 91e9e7c2-76e5-4e0a-8582-6a731cf1ea3d
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dec4e52a-25e8-40ad-8a4c-019ddb4892a2
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: d0ea7d58-a32f-494b-8a65-7bf47d49c598
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c13bf7d3-84d4-4f8e-a273-0ac69e25e9d5
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 4eb55de0-4abf-4efd-b437-ad408cf775c3
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b8ce0f17-475a-4f5a-b45a-8dc3a08fe320
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: b3cf1110-29d3-42fa-bb59-3131e56c3f23
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2997b33a-d68a-46be-8a77-c0e7551b9386
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 47a3c596-74e4-4a28-8c5a-f4a8392d1b4f
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 78bd3a40-bc46-460f-ab28-b03a5fecfb46
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 83f20dbc-df02-4f9c-a049-436586018828
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 90c5fe84-5be7-4dca-b42e-e82b73954123
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 637db059-b609-41e5-a097-566e8c3b4d78
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 1679ac30-e1cb-4cdb-8745-29e91cbb3922
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 62ec931c-bff1-4ff6-8e50-9c1275d23066
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f6581a09-9770-4001-8789-c76c7e807a6b
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 854a091b-88a8-4b04-8eb1-d5be88314856
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 3096f53f-5fd0-4fb2-bda1-68690462ee59
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 9c983685-268c-4575-9175-3236c56fcd77
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ebc740eb-e788-4f14-91d6-916561a1f253
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 82cfff6d-5f4c-4bdf-8a9c-96313076fad0
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 33b74a07-c267-4ef1-b597-697c96b5460f
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: b2dc4842-b8c1-4433-9140-b7aae2415328
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b014027b-3ffb-4a78-bfd7-ea053f888ad1
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 271a51fb-6f5f-4cae-81b6-5cc1cbf9ea8d
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 186315e4-0c89-4003-846b-45b418d40b65
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: df681d05-1138-4bd1-8515-71bd32bbf5ec
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: aee824ee-1e2b-4ba1-921f-914dcf0d9f2e
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 61202475-85d8-4fe5-9bdc-d2f54cdd6667
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2dad3607-113a-4426-a00a-adae7fc526da
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - columnReference:
              columnCounter: 73ab960a-85ef-4e20-a53c-fbe9e778ea78
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ff136762-6e4f-4d94-9bc5-e41075bf3b2b
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 286bbcf8-4b47-4a03-a712-86ff81992d7e
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8c998f41-39dd-4cc7-b4ad-a4707851be8e
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 6a539518-1db5-46b5-a7b9-94740a047f8b
              stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 218c1794-6871-4c6f-ba13-a2c4f1509233
                    stepCounter: e61a2ed1-561b-4139-b027-d0dce2a5da69
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: 14bf6cba-1bbc-45e8-916e-3bde401e2c0a
              DIM_PART: b0f685c5-2190-48d3-8e4a-31cf703035f1
              DIM_SUPPLIER: 34a53b67-f6d4-4857-9fbb-153b378f1382
              STG_LINEITEM_ORDERS: e61a2ed1-561b-4139-b027-d0dce2a5da69
              STG_PARTSUPP: cb5e6516-9adc-421f-8687-c8cd48666c03
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |-
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: f672b22b-1747-4161-aeeb-ac787551c24e
